<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <title>Document</title>
</head>
<body>
    

    <label for="mtitle">Movie Title</label>
    <input type = "text" id="mtitle">
    <label for="mgenre">Movie Genre</label>
    <input type = "text" id="mgenre">
    <br>
    <label for="myear">Release Date (Month and Year):</label>
    <input type = "month" id="myear">
    <label for="mdirector">Director</label>
    <input type = "text" id="mdirector">
    <br>
    <label for="mrating">Rating (between 0 and 10):</label>
    <input type = "number" id="mrating" min="0" max="10">
    <br>

    <button type="button" id="add">Add Movie</button>
    <br>
    <div id="displayHeader">The actual list</div>
    <br>

    <table class = "table table-dark table-striped" id = "movieTable">
        <thead>
            <tr>
                <td>Title</td>
                <td>Genre</td>
                <td>Year</td>
                <td>Director</td>
                <td>Rating</td>
            </tr>
        </thead>
        <tbody id = "table">
            <tr id="display" >
                <td>PlaceholderTitle</td>
                <td>PlaceholderGenre</td>
                <td>PlaceholderYear</td>
                <td>PlaceholderDirector</td>
                <td>PlaceholderRating</td>
            </tr>
        </tbody>
    </table>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    //Start when the html is loaded
    $(document).ready(function(){
        //Initial movie entry
        movie1 = {
        title: "Let Me In",
        genre: "Horror/Romance",
        year: "2010",
        director: "Matt Reeves",
        rating: "7"

        
        }
        //Declaration for list of movie objects
        movieList = [];
        movieList.push(movie1);

        //Clear the HTML table and append the movie list
        $("#table").replaceWith('<tbody id = "table"></tbody>')
        idcount = 0;
        movieList.forEach(function(item){
                    btnhtml = '<button type="button" class="btn btn-danger" id = "'+idcount+'">Delete</button>';
                    $("#table").append('<tr><td>'+item.title+'</td><td>'+item.genre+'</td><td>'+item.year+'</td><td>'+item.director+'</td><td>'+item.rating+'</td><td>'+btnhtml+'</td></tr>')
                    idcount++;
        });


    });
    //Onclick function for the add button
    $("#add").on("click", function(){
        inputMovie = {
        title: "",
        genre: "",
        year: "",
        director: "",
        rating: ""
        }
 
        inputMovie.title = $("#mtitle").val();
        inputMovie.genre = $("#mgenre").val();
        inputMovie.year = $("#myear").val();
        inputMovie.director = $("#mdirector").val();
        inputMovie.rating = $("#mrating").val();
        movieList.push(inputMovie);
        console.log("Movie Added");
        refreshList();
    });
        
    //Function that updates the list with the new entry and updates the table
    function refreshList(){
        //Cleat the list before adding new entries
        $("#table").replaceWith('<tbody id = "table"></tbody>')
            
        //Sort array
        movieList.sort((a, b) => {
            let ta = a.title.toLowerCase(),
                tb = b.title.toLowerCase();

            if (ta < tb) {
                return -1;
            }
            if (ta > tb) {
                return 1;
            }
            return 0;
        });
        idcount = 0;
        document.getElementById("displayHeader").innerHTML = "Your refreshed movie list:";
        movieList.forEach(function(item){
            btnhtml = '<button type="button" class="btn btn-danger" id = "'+idcount+'">Delete</button>';
            $("#table").append('<tr><td>'+item.title+'</td><td>'+item.genre+'</td><td>'+item.year+'</td><td>'+item.director+'</td><td>'+item.rating+'</td><td>'+btnhtml+'</td></tr>')
            idcount++;
        });
        console.log("Table Refreshed");
    }

    $('#movieTable').on('click', 'button.btn.btn-danger', function() {
        movieList.splice(this.id,1);
        console.log("Removed entry with number: "+this.id);
        refreshList();
    });



</script>
</body>
</html>
